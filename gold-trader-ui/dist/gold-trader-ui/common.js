"use strict";(self.webpackChunkgold_trader_ui=self.webpackChunkgold_trader_ui||[]).push([[76],{7593:(N,I,a)=>{a.d(I,{G:()=>W});var d=a(9330),L=a(8810),P=a(3236),v=a(8211),D=a(9974),H=a(8750),$=a(1853),M=a(4360),O=a(5225);const R=(0,$.L)(n=>function(p=null){n(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=p});function i(n,o){const{first:p,each:t,with:e=F,scheduler:s=o??P.E,meta:r=null}=(0,v.v)(n)?{first:n}:"number"==typeof n?{each:n}:n;if(null==p&&null==t)throw new TypeError("No timeout provided.");return(0,D.N)((c,u)=>{let A,l,E=null,g=0;const f=U=>{l=(0,O.N)(u,s,()=>{try{A.unsubscribe(),(0,H.Tg)(e({meta:r,lastValue:E,seen:g})).subscribe(u)}catch(b){u.error(b)}},U)};A=c.subscribe((0,M._)(u,U=>{l?.unsubscribe(),g++,u.next(E=U),t>0&&f(t)},void 0,void 0,()=>{l?.closed||l?.unsubscribe(),E=null})),!g&&f(null!=p?"number"==typeof p?p:+p-s.now():t)})}function F(n){throw new R(n)}var h=a(9437),m=a(6354),y=a(5312),T=a(2615),S=a(5425);let W=(()=>{var n;class o{constructor(t,e){this.http=t,this.authService=e,this.API_URL=y.c.apiUrl,this.DEFAULT_TIMEOUT=3e4}login(t){return this.http.post(`${this.API_URL}/auth/login`,t).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(e=>this.handleError(e)))}logout(){return this.http.post(`${this.API_URL}/auth/logout`,{}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(t=>this.handleError(t)))}getSignals(t){const e=this.buildHttpParams(t),s=this.getAuthHeaders();return this.http.get(`${this.API_URL}/signals`,{params:e,headers:s}).pipe(i(this.DEFAULT_TIMEOUT),(0,m.T)(r=>this.transformSignalResponse(r)),(0,h.W)(r=>this.handleError(r)))}getSignal(t){const e=this.getAuthHeaders();return this.http.get(`${this.API_URL}/signals/${t}`,{headers:e}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(s=>this.handleError(s)))}createSignal(t){const e=this.getAuthHeaders();return this.http.post(`${this.API_URL}/signals`,t,{headers:e}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(s=>this.handleError(s)))}getTrades(t){const e=this.buildHttpParams(t),s=this.getAuthHeaders();return this.http.get(`${this.API_URL}/trades`,{params:e,headers:s}).pipe(i(this.DEFAULT_TIMEOUT),(0,m.T)(r=>this.transformTradeResponse(r)),(0,h.W)(r=>this.handleError(r)))}getTrade(t){const e=this.getAuthHeaders();return this.http.get(`${this.API_URL}/trades/${t}`,{headers:e}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(s=>this.handleError(s)))}createTrade(t){const e=this.getAuthHeaders();return this.http.post(`${this.API_URL}/trades`,t,{headers:e}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(s=>this.handleError(s)))}closeTrade(t,e,s=100){const r=this.getAuthHeaders();return this.http.post(`${this.API_URL}/trades/${t}/close`,{reason:e,percentage:s},{headers:r}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(u=>this.handleError(u)))}getTicks(t="XAUUSD",e=100){const s=this.getAuthHeaders(),r=(new d.Nl).set("symbol",t).set("limit",e.toString());return this.http.get(`${this.API_URL}/market/ticks`,{params:r,headers:s}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(c=>this.handleError(c)))}getCandles(t="XAUUSD",e="M15",s=100){const r=this.getAuthHeaders(),c=(new d.Nl).set("symbol",t).set("timeframe",e).set("limit",s.toString());return this.http.get(`${this.API_URL}/market/candles`,{params:c,headers:r}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(u=>this.handleError(u)))}getBalance(){const t=this.getAuthHeaders();return this.http.get(`${this.API_URL}/account/balance`,{headers:t}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(e=>this.handleError(e)))}getPositions(){const t=this.getAuthHeaders();return this.http.get(`${this.API_URL}/account/positions`,{headers:t}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(e=>this.handleError(e)))}getDailyPerformance(t){const e=this.buildHttpParams(t),s=this.getAuthHeaders();return this.http.get(`${this.API_URL}/performance/daily`,{params:e,headers:s}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(r=>this.handleError(r)))}getWeeklyPerformance(t){const e=this.buildHttpParams(t),s=this.getAuthHeaders();return this.http.get(`${this.API_URL}/performance/weekly`,{params:e,headers:s}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(r=>this.handleError(r)))}getMonthlyPerformance(t){const e=this.buildHttpParams(t),s=this.getAuthHeaders();return this.http.get(`${this.API_URL}/performance/monthly`,{params:e,headers:s}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(r=>this.handleError(r)))}analyzeSmartMoney(t="XAUUSD"){const e=this.getAuthHeaders(),s=(new d.Nl).set("symbol",t);return this.http.post(`${this.API_URL}/analysis/smart-money`,{},{params:s,headers:e}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(r=>this.handleError(r)))}getConfig(){const t=this.getAuthHeaders();return this.http.get(`${this.API_URL}/config`,{headers:t}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(e=>this.handleError(e)))}updateConfig(t){const e=this.getAuthHeaders();return this.http.put(`${this.API_URL}/config`,t,{headers:e}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(s=>this.handleError(s)))}getSystemStatus(){const t=this.getAuthHeaders();return this.http.get(`${this.API_URL}/system/status`,{headers:t}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(e=>this.handleError(e)))}subscribeToWebSocket(t){const e=this.getAuthHeaders();return this.http.post(`${this.API_URL}/websocket/subscribe`,{channels:t},{headers:e}).pipe(i(this.DEFAULT_TIMEOUT),(0,h.W)(s=>this.handleError(s)))}getAuthHeaders(){const t=this.authService.getToken();return new d.Lr({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}buildHttpParams(t){if(!t)return new d.Nl;let e=new d.Nl;return Object.keys(t).forEach(s=>{null!=t[s]&&(e=e.set(s,t[s].toString()))}),e}transformSignalResponse(t){return{signals:t.signals||[],total:t.total||0,limit:t.limit||50,offset:t.offset||0}}transformTradeResponse(t){return{trades:t.trades||[],total:t.total||0,limit:t.limit||50,offset:t.offset||0}}handleError(t){console.error("API Error:",t),401===t.status&&this.authService.logout();let e="An unknown error occurred";return t.error&&t.error.message?e=t.error.message:t.message?e=t.message:t.status&&(e=`HTTP Error: ${t.status}`),(0,L.$)(e)}static#t=n=()=>(this.\u0275fac=function(e){return new(e||o)(T.KVO(d.Qq),T.KVO(S.u))},this.\u0275prov=T.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}))}return n(),o})()}}]);